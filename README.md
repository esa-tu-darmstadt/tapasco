The Task Parallel System Composer (TaPaSCo)
===========================================
![Tapasco logo](icon/tapasco_icon.png)

Master Branch Status: [![pipeline status](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/badges/master/pipeline.svg)](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/commits/master)
Dev Branch Status: [![pipeline status](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/badges/2018.2/pipeline.svg)](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/commits/2018.2)

System Requirements
-------------------
TaPaSCo is known to work in this environment:

*   Intel x86_64 arch
*   Linux kernel 4.4+
*   Fedora 26+, Ubuntu 16.04+
*   Fedora 24/25 does not support debug mode
*   Bash Shell 4.2.x+

Other setups likely work as well, but are untested.

Prerequisites
-------------
To use TaPaSCo, you'll need working installations of

*   Vivado Design Suite 2017.4 or newer
*   Java SDK 8 - 11
*   sbt 0.13.x or newer
*   git
*   python
*   GCC newer than 5.x.x for C++11 support
*   *OPTIONAL:* libncurses for the tapasco-debug application

If you want to use the High-Level Synthesis flow for generating custom IP
cores, you'll also need:

*   Vivado HLS 2017.4+

Check that at least the following are in your `$PATH`:

*   `sbt`
*   `vivado`
*   `git`
*   `bash`
*   \[`vivado_hls`\]

Install sbt
-----------
Installing multiple versions of Java, Scala and tools like sbt can be a hassle.
[SDKman!](http://sdkman.io/) simplifies the process by managing the
installations without root requirements. To install sbt, simply
```
curl -s "https://get.sdkman.io" | bash
```
Then, run in a new terminal:
```
sdk install sbt
```
Try if this worked, via
```
sbt version
```
If `sbt` was successfully installed, it will return its version number.

Basic Setup
-------------------
1.  Open a terminal in the main directory of the repository and source the
    TaPaSCo setup script via `. setup.sh`.
    You need to do this every time you use TaPaSCo (or put it into your
    `~/.bashrc` or `~/.profile`).
2.  Build TaPaSCo: `sbt compile` (this may take a while, `sbt` needs to fetch
    all dependencies etc. once).
2.  Create the necessary jar files with `sbt assembly`.
4.  _Optional_: Run TaPaSCo unit tests: `sbt test`
5.  _Optional_: Generate sample configuration file: `tapasco -n config.json`
    TaPaSCo should exit immediately and `config.json` will include a full
    configuration that can be read with `--configFile`, including one example
    for each kind of job.
6.  Build libraries and _tlkm_ kernel module: `tapasco-build-libs`

When everything completed successfully, **TaPaSCo is ready to use!**

Build a TaPaSCo design
----------------------
1.  Import your kernels
    *   HDL flow: `tapasco import <ZIP> as <ID>`
    *   HLS flow: `tapasco hls <KERNELS>`
2.  Create a composition: `tapasco compose [<KERNEL> x <COUNT>] @ <NUM> MHz -p <PLATFORM>`
3.  Load the bitstream: `tapasco-load-bitstream <BITSTREAM>`
4.  Implement your host software
    *   C API
    *   C++ API

You can get more information about commands with `tapasco help <COMMAND>`.

Acknowledgements
----------------
TaPaSCo is based on [ThreadPoolComposer][1], which was developed by us as part
of the [REPARA project][2], a _Framework Seven (FP7) funded project by the
European Union_.

We would also like to thank [Bluespec, Inc.][3] for making their _Bluespec
SystemVerilog (BSV)_ tools available to us and their permission to distribute
the Verilog code generated by the _Bluespec Compiler (bsc)_.

[1]: https://git.esa.informatik.tu-darmstadt.de/REPARA/threadpoolcomposer.git
[2]: http://repara-project.eu/
[3]: http://bluespec.com/

Releases
----------------

We provided pre-compiled packages for many popular Linux distributions. All packages are build for the x86_64 variant.

### Ubuntu 16.04
[Kernel Driver](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/-/jobs/artifacts/master/raw/tlkm/tlkm.ko?job=build_kernel_ubuntu_16_04)
[Kernel Driver Debug](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/-/jobs/artifacts/master/raw/tlkm/tlkm.ko?job=build_kernel_ubuntu_16_04_debug)
[Runtime (DEB)](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/-/jobs/artifacts/master/raw/build/tapasco-2018.2.1-Linux.deb?job=build_tapasco_ubuntu_16_04)
[Runtime Debug (DEB)](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/-/jobs/artifacts/master/raw/build/tapasco-2018.2.1-Linux.deb?job=build_tapasco_ubuntu_16_04_debug)

### Ubuntu 18.04
[Kernel Driver](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/-/jobs/artifacts/master/raw/tlkm/tlkm.ko?job=build_kernel_ubuntu_18_04)
[Kernel Driver Debug](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/-/jobs/artifacts/master/raw/tlkm/tlkm.ko?job=build_kernel_ubuntu_18_04_debug)
[Runtime (DEB)](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/-/jobs/artifacts/master/raw/build/tapasco-2018.2.1-Linux.deb?job=build_tapasco_ubuntu_18_04)
[Runtime Debug (DEB)](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/-/jobs/artifacts/master/raw/build/tapasco-2018.2.1-Linux.deb?job=build_tapasco_ubuntu_18_04_debug)

### Fedora 27
[Kernel Driver](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/-/jobs/artifacts/master/raw/tlkm/tlkm.ko?job=build_kernel_fedora_27)
[Kernel Driver Debug](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/-/jobs/artifacts/master/raw/tlkm/tlkm.ko?job=build_kernel_fedora_27_debug)
[Runtime (RPM)](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/-/jobs/artifacts/master/raw/build/tapasco-2018.2.1-Linux.rpm?job=build_tapasco_fedora_27)
[Runtime Debug (RPM)](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/-/jobs/artifacts/master/raw/build/tapasco-2018.2.1-Linux.rpm?job=build_tapasco_fedora_27_debug)

### Fedora 28
[Kernel Driver](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/-/jobs/artifacts/master/raw/tlkm/tlkm.ko?job=build_kernel_fedora_28)
[Kernel Driver Debug](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/-/jobs/artifacts/master/raw/tlkm/tlkm.ko?job=build_kernel_fedora_28_debug)
[Runtime (RPM)](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/-/jobs/artifacts/master/raw/build/tapasco-2018.2.1-Linux.rpm?job=build_tapasco_fedora_28)
[Runtime Debug (RPM)](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/-/jobs/artifacts/master/raw/build/tapasco-2018.2.1-Linux.rpm?job=build_tapasco_fedora_28_debug)

### Fedora 29
[Kernel Driver](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/-/jobs/artifacts/master/raw/tlkm/tlkm.ko?job=build_kernel_fedora_29)
[Kernel Driver Debug](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/-/jobs/artifacts/master/raw/tlkm/tlkm.ko?job=build_kernel_fedora_29_debug)
[Runtime (RPM)](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/-/jobs/artifacts/master/raw/build/tapasco-2018.2.1-Linux.rpm?job=build_tapasco_fedora_29)
[Runtime Debug (RPM)](https://git.esa.informatik.tu-darmstadt.de/tapasco/tapasco/-/jobs/artifacts/master/raw/build/tapasco-2018.2.1-Linux.rpm?job=build_tapasco_fedora_29_debug)
